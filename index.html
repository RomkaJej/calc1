<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MLM-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Ö–æ–¥–∞</title>
  
  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ React, ReactDOM –∏ Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ TailwindCSS –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-green-600">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function MLMCalculator() {
      // –ò–∑–Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
      const [rank, setRank] = useState(1); // –†–∞–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const [lines, setLines] = useState([0]);  // –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è 3 –ª–∏–Ω–∏–π
      const [pvPerUser, setPvPerUser] = useState(90);
      const [isNewbiePeriod, setIsNewbiePeriod] = useState(true);
      const [desiredIncome, setDesiredIncome] = useState(0); // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∂–µ–ª–∞–µ–º–æ–≥–æ –¥–æ—Ö–æ–¥–∞

      const linePercents = [
        0.1, 0.08, 0.06, 0.05, 0.04, 0.03, 0.02, 0.01, 0.005, 0.005 // –ü—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –ª–∏–Ω–∏–∏
      ];

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±–æ–Ω—É—Å–∞ –ø–æ –ª–∏–Ω–∏–∏
      const getLineBonus = (users, percent) => users * pvPerUser * percent;

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –±–æ–Ω—É—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ª–∏–Ω–∏–π
      const calculateBonus = () => {
        let totalBonus = 0;
        for (let i = 0; i < lines.length; i++) {
          totalBonus += getLineBonus(lines[i], linePercents[i]);
        }
        return totalBonus;
      }

      // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –±–æ–Ω—É—Å—ã
      const structuralBonus = calculateBonus();
      const gvBonus = getLineBonus(lines[0], 0.1); // gv –≤—Å–µ–≥–¥–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –ª–∏–Ω–∏–∏
      const newbieBonus = isNewbiePeriod ? structuralBonus * 0.25 : 0;

      // –°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–æ–Ω—É—Å –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –ø–µ—Ä–≤–æ–π –ª–∏–Ω–∏–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã 1 —É—á–∞—Å—Ç–Ω–∏–∫
      const startBonus = (isNewbiePeriod && lines[0] > 0) ? 30 : 0; 
      const totalEur = structuralBonus + newbieBonus + startBonus;

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –ª–∏–Ω–∏—è—Ö
      const handleLineChange = (index, value) => {
        const updatedLines = [...lines];
        updatedLines[index] = value;
        setLines(updatedLines);
      };

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤–µ–¥—É—â–∏—Ö –Ω—É–ª–µ–π
      const removeLeadingZero = (value) => {
        return value.replace(/^0+/, '') || '0'; // –£–±–∏—Ä–∞–µ—Ç –Ω—É–ª–∏ –∏ —Å—Ç–∞–≤–∏—Ç 0, –µ—Å–ª–∏ –ø—É—Å—Ç–æ
      };

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å –Ω—É–∂–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞
      const setIncome = (income) => {
        setDesiredIncome(income);
        let updatedLines = [...lines];
        let remainingIncome = income;

        // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π –ª–∏–Ω–∏–∏
        for (let i = 0; i < updatedLines.length; i++) {
          if (remainingIncome <= 0) break;
          let minUsers = Math.ceil(remainingIncome / (pvPerUser * linePercents[i])); // –û–∫—Ä—É–≥–ª—è–µ–º –≤–≤–µ—Ä—Ö
          updatedLines[i] = minUsers;
          remainingIncome -= getLineBonus(minUsers, linePercents[i]);
        }
        setLines(updatedLines);

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–Ω–≥–∞, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è
        const newRank = Math.min(updatedLines.length, 10); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–Ω–≥ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ª–∏–Ω–∏–π
        setRank(newRank);
      };

      // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∑–∞–¥–∞–Ω–Ω–æ–π —Å—É–º–º—ã
      const calculateMinUsers = (income) => {
        let totalIncome = 0;
        let usersForIncome = [];
        for (let i = 0; i < linePercents.length; i++) {
          let minUsers = Math.ceil(income / (pvPerUser * linePercents[i])); // –û–∫—Ä—É–≥–ª—è–µ–º –≤–≤–µ—Ä—Ö
          usersForIncome[i] = minUsers;
          totalIncome += getLineBonus(minUsers, linePercents[i]);
          if (totalIncome >= income) break;
        }
        return usersForIncome;
      };

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫
      const handleQuickIncome = (income) => {
        setIncome(income);
        const minUsers = calculateMinUsers(income);
        setLines(minUsers);
      };

      useEffect(() => {
        // –û–±—Ä–µ–∑–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–Ω–≥–∞
        const maxLines = rank;
        const updatedLines = [...lines];
        if (updatedLines.length > maxLines) {
          updatedLines.splice(maxLines); // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ª–∏–Ω–∏–∏
        }
        setLines(updatedLines);
      }, [rank]);

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞–Ω–≥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª—é–¥–µ–π
      const calculateRank = () => {
        let maxRank = 0;
        for (let i = 0; i < lines.length; i++) {
          if (lines[i] > 0) {
            maxRank = i + 1;
          }
        }
        return maxRank;
      };

      const rank = calculateRank(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–Ω–≥–∞

      return (
        <div className="max-w-lg mx-auto mt-10 p-8 bg-white rounded-2xl shadow-lg space-y-6">
          <div className="flex justify-center items-center mb-6">
            <img 
              src="https://bfc24.com/_next/image?url=https%3A%2F%2Fbfc24.com%2Fapi%2Ffiles%2FLayer_1.png&w=3840&q=75" 
              alt="Logo" 
              className="h-12 w-auto" 
            />
          </div>
          
          <h1 className="text-3xl font-bold text-center text-gray-800">MLM-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Ö–æ–¥–∞</h1>

          {/* –ö–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –¥–æ—Ö–æ–¥–∞ */}
          <div className="flex justify-between gap-4 mb-6">
            <button 
              onClick={() => handleQuickIncome(500)} 
              className="bg-green-500 text-white py-2 px-4 rounded-lg"
            >
              ‚Ç¨500
            </button>
            <button 
              onClick={() => handleQuickIncome(1000)} 
              className="bg-green-500 text-white py-2 px-4 rounded-lg"
            >
              ‚Ç¨1000
            </button>
            <button 
              onClick={() => handleQuickIncome(1500)} 
              className="bg-green-500 text-white py-2 px-4 rounded-lg"
            >
              ‚Ç¨1500
            </button>
          </div>

          <div className="space-y-4 mt-6">
            <label className="block text-gray-600">–¢–µ–∫—É—â–∏–π —Ä–∞–Ω–≥ (1-10):</label>
            <input 
              type="text"
              value={rank} 
              readOnly 
              className="w-full bg-gray-200 p-3 rounded-lg text-center text-gray-800"
            />
            <p className="text-center">–†–∞–Ω–≥: {rank}</p>

            {/* –ü–æ–ª—è –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –ª–∏–Ω–∏—è—Ö */}
            {[...Array(rank)].map((_, index) => (
              <div key={index}>
                <label>–ö–æ–ª-–≤–æ Club members –≤ {index + 1}-–π –ª–∏–Ω–∏–∏:</label>
                <input 
                  type="text" 
                  value={removeLeadingZero(lines[index].toString())} // –£–±–∏—Ä–∞–µ–º –≤–µ–¥—É—â–∏–µ –Ω—É–ª–∏
                  onChange={e => handleLineChange(index, +e.target.value)} 
                  className="input-field border p-3 w-full rounded-lg focus:ring-2 focus:ring-green-400"
                  min="1"
                  max="100"
                />
              </div>
            ))}

            <label>–°–∫–æ–ª—å–∫–æ PV –Ω–∞ –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞:</label>
            <input 
              type="number" 
              value={pvPerUser} 
              onChange={e => setPvPerUser(+e.target.value)} 
              className="input-field border p-3 w-full rounded-lg focus:ring-2 focus:ring-green-400"
              min="1"
              max="1000"
            />

            <label className="flex items-center gap-2">
              <input type="checkbox" checked={isNewbiePeriod} onChange={() => setIsNewbiePeriod(!isNewbiePeriod)} />
              –Ø –≤ –Ω–æ–≤–∏—á–∫–æ–≤–æ–º –ø–µ—Ä–∏–æ–¥–µ
            </label>
          </div>

          <div className="p-4 bg-gray-100 rounded-xl text-lg space-y-3 shadow-lg">
            <p><strong className="text-blue-600">–°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –±–æ–Ω—É—Å:</strong> ‚Ç¨{structuralBonus.toFixed(2)}</p>
            <p><strong>–ü–æ–¥–∞—Ä–æ—á–Ω—ã–π –±–æ–Ω—É—Å (GV):</strong> {gvBonus.toFixed(2)} GV</p>
            <p><strong>–ë–æ–Ω—É—Å –Ω–æ–≤–∏—á–∫–∞:</strong> ‚Ç¨{newbieBonus.toFixed(2)}</p>
            <p><strong>–°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–æ–Ω—É—Å:</strong> ‚Ç¨{startBonus.toFixed(2)}</p>
            <hr />
            <p><strong>üí∞ –û–±—â–∏–π –¥–æ—Ö–æ–¥:</strong> ‚Ç¨{totalEur.toFixed(2)}</p>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<MLMCalculator />);
  </script>
</body>

</html>
